@Test public void doRegisterAndAvailable() throws Exception {
  registry.doRegister(serviceUrl);
  registry.doRegister(serviceUrl2);
  Assert.assertTrue(client.isRegistered(serviceid));
  Assert.assertFalse(client.isWorking(serviceid));
  Assert.assertTrue(client.isRegistered(serviceid2));
  Assert.assertFalse(client.isWorking(serviceid2));
  registry.doAvailable(null);
  Thread.sleep(sleepTime);
  Assert.assertTrue(client.isWorking(serviceid));
  Assert.assertTrue(client.isWorking(serviceid2));
  registry.doUnavailable(null);
  Thread.sleep(sleepTime);
  Assert.assertFalse(client.isWorking(serviceid));
  Assert.assertFalse(client.isWorking(serviceid2));
  registry.doUnregister(serviceUrl);
  Assert.assertFalse(client.isRegistered(serviceid));
  Assert.assertTrue(client.isRegistered(serviceid2));
  registry.doUnregister(serviceUrl2);
  Assert.assertFalse(client.isRegistered(serviceid2));
}
